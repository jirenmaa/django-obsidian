{% extends "base_app.html" %} {% load static %} {% block title %}
{{object.username}} â€’ Djraft {% endblock %} {% block inner %}
<section class="section-content">
  <user-detail>
    <div class="flex mx-10">
      <user-info class="w-2/12 mx-4">
        <div class="sticky">
          <picture>
            <a href="{% url 'me:settings' %}">
              <img src="{{object.avatar.url}}" class="w-9/12" alt="" />
            </a>
          </picture>
          <p class="tracking-widest pt-3">ABOUT</p>
          <p class="font-semibold mb-2">{{object.username}}</p>
          <div class="w-9/12 text-sm text-gray-600">
            {{ object.bio }}
          </div>
        </div>
      </user-info>
      <user-articles class="w-10/12 mt-5 mx-12">
        {% for article in stories %}
        <article>
          <p class="pb-6 text-sm text-gray-600">
            Published on {{article.created_at|date:"M, j Y"}}
          </p>
          <a href="{{ article.get_absolute_url }}">
            <h2 id="title" class="font-semibold text-6xl inline-block">
              {{ article.title }}
            </h2>
            <h3 id="description" class="pt-3 pb-5 text-2xl text-gray-600">
              {% if article.description|length > 225 %}
                {{ article.description|slice:"225" }} ...
              {% else %}
                {{ article.description }}
              {% endif %}
            </h3>
            {% if article.cover %}
            <div>
              <picture class="image-wrapper">
                <div id="picture">
                  <img
                    src="{{ article.cover.url }}"
                    class="w-full"
                    alt=""
                    srcset=""
                  />
                </div>
              </picture>
            </div>
            {% endif %}
            <div id="content" class="pt-6">
              {% if article.body|length > 1120 %}
                {{article.body|linebreaksbr|slice:"1120" }} ...
              {% else %}
                {{ article.body|linebreaksbr }}
              {% endif %}
            </div>
          </a>
          <p class="mt-10 mb-8">
            <a href="#" class="text-green-500 text-sm">
              Read more about this article
            </a>
          </p>
          <div class="footer flex inline-block mb-8" id="{{article.id}}">
            <div class="flex items-center upvote" onclick="like(this)">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="feather feather-arrow-up mr-1"
              >
                <line x1="12" y1="19" x2="12" y2="5"></line>
                <polyline points="5 12 12 5 19 12"></polyline>
              </svg>
              {% if article.get_total_likes > 0 %}
              <span class="mr-8">{{ article.get_total_likes }}</span>
              {% endif %}
            </div>

            <div class="flex items-center response" onclick="like(this)">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="feather feather-response-circle mr-1"
              >
                <path
                  d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"
                ></path>
              </svg>
            </div>
          </div>
        </article>
        {% endfor %}
      </user-articles>
    </div>
  </user-detail>
</section>
<script>
  function like(element) {
    var parent = element.parentNode;
    const url =
      document.location.protocol +
      "//" +
      document.location.host +
      "/story/like/" +
      parent.id;
    console.log();

    fetch(url, {
      method: "GET",
    }).then((response) => console.log(response));
  }
</script>
{% endblock %}
